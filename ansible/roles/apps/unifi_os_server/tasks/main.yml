---
- name: Install UniFi OS Server bootstrap prerequisites
  ansible.builtin.apt:
    name:
      - ca-certificates
      - curl
    state: present
    update_cache: true

- name: Download UniFi OS Server community installer script
  ansible.builtin.get_url:
    url: "https://raw.githubusercontent.com/dgodibadze/UniFi_OS_Server/main/install_uosserver.sh"
    dest: "/tmp/install_uosserver.sh"
    mode: "0755"

- name: Run UniFi OS Server community installer script
  ansible.builtin.command:
    cmd: "/tmp/install_uosserver.sh"

- name: Ensure UniFi OS Server service is running (if present)
  ansible.builtin.systemd:
    name: uosserver
    enabled: true
    state: started
  failed_when: false
